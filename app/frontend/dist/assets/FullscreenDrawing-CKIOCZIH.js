import{c as h,j as e}from"./ui-CmEgarRF.js";import{r as s,f as R,u as $}from"./vendor-Ce54acmE.js";import{i as E,h as D,g as b,j as I}from"./index-BjMOTf-D.js";import"./auth-B5F6nbqB.js";import"./utils-DH2Y5gFI.js";function z({title:l,titleId:r,...o},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},o),l?s.createElement("title",{id:r},l):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"}))}const T=s.forwardRef(z);function W({title:l,titleId:r,...o},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},o),l?s.createElement("title",{id:r},l):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const A=s.forwardRef(W);function U({title:l,titleId:r,...o},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},o),l?s.createElement("title",{id:r},l):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const _=s.forwardRef(U),K=()=>{const{eventId:l}=R(),r=$(),[o,c]=s.useState(!1),[P,V]=s.useState([]),[d,v]=s.useState(null),[j,N]=s.useState(!1),[m,w]=s.useState(null),[y,f]=s.useState(!1),[S,x]=s.useState([{value:"0",isSpinning:!1,finalValue:"0"},{value:"0",isSpinning:!1,finalValue:"0"},{value:"0",isSpinning:!1,finalValue:"0"},{value:"1",isSpinning:!1,finalValue:"1"}]),[g,p]=s.useState("idle");s.useEffect(()=>{l&&k()},[l]);const k=async()=>{try{const n=(await E.get(`/api/admin/events/${l}/prizes`)).data.filter(u=>u.quantity>0);V(n)}catch{h.error("Gagal memuat daftar hadiah")}},F=s.useCallback(()=>{document.fullscreenElement?document.exitFullscreen().then(()=>{c(!1)}):document.documentElement.requestFullscreen().then(()=>{c(!0)}).catch(()=>{h.error("Gagal masuk mode fullscreen")})},[]),C=t=>{const n=t.padStart(4,"0").split("");x(i=>i.map(a=>({...a,isSpinning:!0}))),p("spinning");const u=setInterval(()=>{x(i=>i.map(a=>({...a,value:Math.floor(Math.random()*10).toString()})))},100);setTimeout(()=>{p("stopping"),setTimeout(()=>{x(i=>{const a=[...i];return a[0]={...a[0],isSpinning:!1,value:n[0],finalValue:n[0]},a})},1e3),setTimeout(()=>{x(i=>{const a=[...i];return a[1]={...a[1],isSpinning:!1,value:n[1],finalValue:n[1]},a})},2e3),setTimeout(()=>{x(i=>{const a=[...i];return a[2]={...a[2],isSpinning:!1,value:n[2],finalValue:n[2]},a})},3e3),setTimeout(()=>{clearInterval(u),x(i=>{const a=[...i];return a[3]={...a[3],isSpinning:!1,value:n[3],finalValue:n[3]},a}),p("complete"),setTimeout(()=>{f(!0)},1e3)},4e3)},2e3)},L=async()=>{if(!d){h.error("Pilih hadiah terlebih dahulu");return}N(!0),f(!1),w(null);try{const t=await E.post(`/api/admin/events/${l}/prize_drawings/${d.id}/draw`);if(t.data.success){const n=t.data.winner,u={id:n.id,name:n.name,registrationNumber:n.registration_number,institution:n.institution,email:n.email,phoneNumber:n.phone_number,prizeName:d.name};w(u);const i=n.registration_number.split("-")[1]||n.registration_number.slice(-4);C(i),h.success("Undian berhasil!")}}catch(t){console.error("Error drawing winner:",t),h.error(t.response?.data?.error||"Gagal mengundi hadiah")}finally{N(!1)}},M=()=>{w(null),f(!1),p("idle"),x([{value:"0",isSpinning:!1,finalValue:"0"},{value:"0",isSpinning:!1,finalValue:"0"},{value:"0",isSpinning:!1,finalValue:"0"},{value:"1",isSpinning:!1,finalValue:"1"}])};return e.jsxs("div",{className:`min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 ${o?"p-0":"p-4"}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-yellow-400/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-400/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl animate-pulse delay-2000"})]}),e.jsxs("div",{className:"relative z-10 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>r(-1),className:"p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Prize Drawing"}),e.jsxs("p",{className:"text-white/60",children:["Event ID: ",l]})]})]}),e.jsxs("button",{onClick:F,className:"flex items-center space-x-2 px-4 py-2 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-all backdrop-blur-sm",children:[o?e.jsx(T,{className:"w-5 h-5"}):e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:o?"Exit Fullscreen":"Fullscreen"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-12",children:[!d&&e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsx("h2",{className:"text-3xl font-bold text-white text-center mb-8",children:"Pilih Hadiah untuk Diundi"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(t=>e.jsx("button",{onClick:()=>v(t),className:"p-6 bg-white/10 rounded-2xl backdrop-blur-sm border border-white/20 hover:bg-white/20 transition-all transform hover:-translate-y-1 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-400 rounded-xl flex items-center justify-center",children:e.jsx(b,{className:"w-6 h-6 text-yellow-900"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:t.name}),e.jsxs("p",{className:"text-white/60",children:["Kategori: ",t.category]}),e.jsxs("p",{className:"text-white/80",children:["Tersisa: ",t.quantity]})]})]})},t.id))})]}),d&&e.jsxs("div",{className:"w-full max-w-6xl space-y-12",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-4 px-8 py-4 bg-white/10 rounded-2xl backdrop-blur-sm border border-white/20",children:[e.jsx(b,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:d.name}),e.jsxs("p",{className:"text-white/60",children:["Mengundi hadiah ",d.category]})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"flex space-x-4",children:S.map((t,n)=>e.jsx("div",{className:`
                        w-32 h-48 bg-gradient-to-b from-gray-800 to-gray-900 rounded-2xl border-4 border-yellow-400 
                        flex items-center justify-center text-8xl font-bold text-yellow-400 shadow-2xl
                        ${t.isSpinning?"animate-pulse":""}
                        ${g==="complete"?"animate-bounce":""}
                      `,children:e.jsx("span",{className:t.isSpinning?"blur-sm":"",children:t.value})},n))})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/60 text-xl mb-2",children:"Nomor Peserta"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-6 py-3 bg-white/10 rounded-xl backdrop-blur-sm",children:[e.jsx("span",{className:"text-white/40 text-2xl font-mono",children:"E1-"}),e.jsx("span",{className:"text-white text-3xl font-mono font-bold",children:S.map(t=>t.value).join("")})]})]}),g==="idle"&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:L,disabled:j,className:"inline-flex items-center space-x-3 px-12 py-6 bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 font-bold text-2xl rounded-2xl shadow-2xl hover:shadow-3xl transform hover:-translate-y-2 transition-all disabled:opacity-50 disabled:transform-none",children:[e.jsx(_,{className:"w-8 h-8"}),e.jsx("span",{children:j?"Mengundi...":"MULAI UNDIAN"})]})}),y&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-gradient-to-br from-yellow-400 to-orange-500 rounded-3xl p-12 max-w-2xl w-full mx-4 text-center shadow-3xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(b,{className:"w-24 h-24 mx-auto text-yellow-900 mb-4"}),e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-2",children:"ðŸŽ‰ SELAMAT! ðŸŽ‰"}),e.jsxs("p",{className:"text-xl text-gray-800",children:["Pemenang ",m.prizeName]})]}),e.jsxs("div",{className:"bg-white/20 rounded-2xl p-8 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[e.jsx(I,{className:"w-12 h-12 text-gray-900"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-bold text-gray-900",children:m.name}),e.jsxs("p",{className:"text-xl text-gray-800",children:["No. ",m.registrationNumber]})]})]}),e.jsx("p",{className:"text-lg text-gray-800",children:m.institution})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>f(!1),className:"flex-1 px-6 py-3 bg-white/20 text-gray-900 font-semibold rounded-xl hover:bg-white/30 transition-all",children:"Tutup"}),e.jsx("button",{onClick:()=>{M(),v(null),k()},className:"flex-1 px-6 py-3 bg-gray-900 text-white font-semibold rounded-xl hover:bg-gray-800 transition-all",children:"Undian Selanjutnya"})]})]})}),g!=="idle"&&!y&&e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:M,className:"px-8 py-4 bg-white/10 text-white font-semibold rounded-xl border border-white/20 hover:bg-white/20 transition-all backdrop-blur-sm",children:"Reset Undian"})})]})]})]})]})};export{K as FullscreenDrawing,K as default};
