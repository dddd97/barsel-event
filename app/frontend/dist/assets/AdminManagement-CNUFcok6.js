import{c as i,j as e,o as $,U as b,p as B,q as _,S as Z,r as ee,s as C,T as q,e as F,E as K}from"./ui-CmEgarRF.js";import{r as l}from"./vendor-Ce54acmE.js";import{u as se,i as y}from"./index-BjMOTf-D.js";import"./auth-B5F6nbqB.js";import"./utils-DH2Y5gFI.js";const ie=()=>{const{user:o}=se(),[m,W]=l.useState([]),[v,S]=l.useState([]),[G,E]=l.useState(!0),[H,f]=l.useState(!1),[n,D]=l.useState(null),[N,O]=l.useState(!1),[w,J]=l.useState(!1),[x,Q]=l.useState(""),[h,V]=l.useState("all"),[r,d]=l.useState({name:"",email:"",password:"",passwordConfirmation:"",role:"admin"}),[u,L]=l.useState(!1),[g,M]=l.useState(null),k=o?.role==="super_admin";l.useEffect(()=>{if(!k){i.error("Akses ditolak. Hanya super admin yang dapat mengakses halaman ini.");return}A()},[k]);const A=async()=>{try{E(!0);const s=await y.get("/api/admin/admins");W(s.data),S(s.data)}catch(s){console.error("Error fetching admins:",s),i.error("Gagal memuat data admin")}finally{E(!1)}};l.useEffect(()=>{let s=m;x&&(s=s.filter(a=>a.name.toLowerCase().includes(x.toLowerCase())||a.email.toLowerCase().includes(x.toLowerCase()))),h!=="all"&&(s=s.filter(a=>a.role===h)),S(s)},[m,x,h]);const X=async s=>{if(s.preventDefault(),r.password!==r.passwordConfirmation){i.error("Password dan konfirmasi password tidak cocok");return}L(!0);try{const a={name:r.name,email:r.email,role:r.role,...r.password&&{password:r.password,password_confirmation:r.passwordConfirmation}};if(n){const t=await y.put(`/api/admin/admins/${n.id}`,{admin:a});console.log("Update response:",t.data),i.success("Admin berhasil diperbarui")}else{const t=await y.post("/api/admin/admins",{admin:a});console.log("Create response:",t.data),i.success("Admin baru berhasil ditambahkan")}f(!1),T(),A()}catch(a){console.error("Error saving admin:",a),console.error("Error response:",a.response?.data);let t="Gagal menyimpan data admin";a.response?.data?.error&&(t=a.response.data.error,a.response.data.details&&Array.isArray(a.response.data.details)&&(t+=": "+a.response.data.details.join(", "))),i.error(t)}finally{L(!1)}},z=s=>{D(s),d({name:s.name,email:s.email,password:"",passwordConfirmation:"",role:s.role}),f(!0)},P=async s=>{if(s.id===o?.id){i.error("Anda tidak dapat menghapus akun Anda sendiri");return}if(confirm(`Apakah Anda yakin ingin menghapus admin "${s.name}"?`)){M(s.id);try{await y.delete(`/api/admin/admins/${s.id}`),i.success("Admin berhasil dihapus"),A()}catch(a){console.error("Error deleting admin:",a);const t=a.response?.data?.error||"Gagal menghapus admin";i.error(t)}finally{M(null)}}},T=()=>{d({name:"",email:"",password:"",passwordConfirmation:"",role:"admin"}),D(null)},R=()=>{u||(f(!1),T())},I=s=>{switch(s){case"super_admin":return e.jsx(B,{className:"w-4 h-4"});case"admin":return e.jsx(_,{className:"w-4 h-4"});case"moderator":return e.jsx(b,{className:"w-4 h-4"});default:return e.jsx(b,{className:"w-4 h-4"})}},U=s=>{switch(s){case"super_admin":return"bg-purple-100 text-purple-800 border-purple-200";case"admin":return"bg-blue-100 text-blue-800 border-blue-200";case"moderator":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Y=()=>{const s=m.length,a=m.filter(p=>p.role==="super_admin").length,t=m.filter(p=>p.role==="admin").length,c=m.filter(p=>p.role==="moderator").length;return{total:s,superAdmins:a,regularAdmins:t,moderators:c}};if(!k)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Akses Ditolak"}),e.jsx("p",{className:"text-gray-600",children:"Anda tidak memiliki izin untuk mengakses halaman ini."})]})});const j=Y();return G?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Memuat data admin..."})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-2xl p-8 text-white",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"mb-6 lg:mb-0",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Kelola Administrator"}),e.jsx("p",{className:"text-blue-100 text-lg",children:"Kelola akun dan hak akses administrator sistem"})]}),e.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center space-x-3 bg-white text-blue-600 px-6 py-3 rounded-xl hover:bg-blue-50 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[e.jsx($,{size:20}),e.jsx("span",{children:"Tambah Admin"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Total Admin"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(b,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Super Admin"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.superAdmins})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(B,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Admin"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.regularAdmins})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(_,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Moderator"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.moderators})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(b,{className:"w-6 h-6 text-green-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Cari admin berdasarkan nama atau email...",value:x,onChange:s=>Q(s.target.value),className:"pl-10 pr-4 py-3 w-full border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{className:"text-gray-400 w-5 h-5"}),e.jsxs("select",{value:h,onChange:s=>V(s.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white",children:[e.jsx("option",{value:"all",children:"Semua Role"}),e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"moderator",children:"Moderator"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:v.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada admin ditemukan"}),e.jsx("p",{className:"text-gray-500",children:x||h!=="all"?"Coba ubah filter atau kata kunci pencarian":"Belum ada admin yang terdaftar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Administrator"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Role & Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Bergabung"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:v.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative h-12 w-12 rounded-xl shadow-sm overflow-hidden border-2 border-white",children:[e.jsx("img",{src:s.avatar?s.avatar.startsWith("http")?s.avatar:`/uploads/avatars/${s.avatar}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=3b82f6&color=ffffff&size=128`,alt:s.name,className:"w-full h-full object-cover",onError:a=>{const t=a.currentTarget;t.style.display="none";const c=t.nextElementSibling;c&&(c.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center hidden",children:e.jsx("span",{className:"text-lg font-bold text-white",children:s.name.charAt(0).toUpperCase()})})]}),s.id===o?.id&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:s.name}),s.id===o?.id&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Anda"})]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium border ${U(s.role)}`,children:[I(s.role),e.jsx("span",{children:s.roleDisplayName})]})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:new Date(s.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString("id-ID",{weekday:"long"})})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>z(s),className:"inline-flex items-center p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Admin",children:e.jsx(C,{size:16})}),s.id!==o?.id&&e.jsx("button",{onClick:()=>P(s),disabled:g===s.id,className:"inline-flex items-center p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Hapus Admin",children:g===s.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-red-600 border-t-transparent"}):e.jsx(q,{size:16})})]})})]},s.id))})]})}),e.jsx("div",{className:"lg:hidden",children:e.jsx("div",{className:"divide-y divide-gray-100",children:v.map(s=>e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative h-12 w-12 rounded-xl shadow-sm overflow-hidden border-2 border-white",children:[e.jsx("img",{src:s.avatar?s.avatar.startsWith("http")?s.avatar:`/uploads/avatars/${s.avatar}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=3b82f6&color=ffffff&size=128`,alt:s.name,className:"w-full h-full object-cover",onError:a=>{const t=a.currentTarget;t.style.display="none";const c=t.nextElementSibling;c&&(c.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center hidden",children:e.jsx("span",{className:"text-lg font-bold text-white",children:s.name.charAt(0).toUpperCase()})})]}),s.id===o?.id&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 truncate",children:s.name}),s.id===o?.id&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Anda"})]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.email})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>z(s),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(C,{size:16})}),s.id!==o?.id&&e.jsx("button",{onClick:()=>P(s),disabled:g===s.id,className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g===s.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-red-600 border-t-transparent"}):e.jsx(q,{size:16})})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium border ${U(s.role)}`,children:[I(s.role),e.jsx("span",{children:s.roleDisplayName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})})]})]})]})},s.id))})})]})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md transform transition-all duration-200 scale-100",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:n?e.jsx(C,{className:"w-5 h-5 text-blue-600"}):e.jsx($,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:n?"Edit Administrator":"Tambah Administrator Baru"}),e.jsx("p",{className:"text-sm text-gray-500",children:n?"Perbarui informasi administrator":"Buat akun administrator baru"})]})]}),e.jsx("button",{onClick:R,disabled:u,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:X,className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nama Lengkap"}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:s=>d({...r,name:s.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Masukkan nama lengkap"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Alamat Email"}),e.jsx("input",{type:"email",required:!0,value:r.email,onChange:s=>d({...r,email:s.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"admin@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Role Administrator"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:r.role,onChange:s=>d({...r,role:s.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none bg-white",children:[e.jsx("option",{value:"admin",children:"Admin - Kelola event dan peserta"}),e.jsx("option",{value:"super_admin",children:"Super Admin - Akses penuh sistem"}),e.jsx("option",{value:"moderator",children:"Moderator - Kelola peserta saja"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Password",n&&e.jsx("span",{className:"text-gray-500 font-normal",children:" (kosongkan jika tidak ingin mengubah)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",required:!n,value:r.password,onChange:s=>d({...r,password:s.target.value}),className:"w-full px-4 py-3 pr-12 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Minimal 6 karakter",minLength:6}),e.jsx("button",{type:"button",onClick:()=>O(!N),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:N?e.jsx(F,{size:18}):e.jsx(K,{size:18})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Konfirmasi Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:w?"text":"password",required:!n||r.password!=="",value:r.passwordConfirmation,onChange:s=>d({...r,passwordConfirmation:s.target.value}),className:"w-full px-4 py-3 pr-12 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Ulangi password",minLength:6}),e.jsx("button",{type:"button",onClick:()=>J(!w),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:w?e.jsx(F,{size:18}):e.jsx(K,{size:18})})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:R,disabled:u,className:"px-6 py-3 text-sm font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Batal"}),e.jsxs("button",{type:"submit",disabled:u,className:"px-8 py-3 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-lg flex items-center space-x-2",children:[u&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),e.jsx("span",{children:u?n?"Memperbarui...":"Menambahkan...":n?"Perbarui Admin":"Tambah Admin"})]})]})]})]})})]})};export{ie as default};
