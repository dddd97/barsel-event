import{c as l,j as e}from"./ui-CmEgarRF.js";import{r as n}from"./vendor-Ce54acmE.js";import{u as A,i as y,L as D}from"./index-BjMOTf-D.js";import N from"./AdminLayout-Bdj-l822.js";import"./auth-B5F6nbqB.js";import"./utils-DH2Y5gFI.js";const H=()=>{const{checkAuth:v}=A(),[t,h]=n.useState(null),[P,g]=n.useState(!0),[o,x]=n.useState(!1),[m,b]=n.useState(!1),[w,p]=n.useState(null),[j,f]=n.useState(null),[s,u]=n.useState({name:"",email:"",currentPassword:"",newPassword:"",confirmPassword:""});n.useEffect(()=>{k()},[]);const k=async()=>{try{g(!0);const a=await y.get("/api/admin/profile");h(a.data),u({name:a.data.name,email:a.data.email,currentPassword:"",newPassword:"",confirmPassword:""})}catch(a){console.error("Error fetching profile:",a),l.error("Gagal memuat profil")}finally{g(!1)}},c=a=>{const{name:r,value:i}=a.target;u(d=>({...d,[r]:i}))},C=a=>{const r=a.target.files?.[0];if(r){if(!["image/png","image/jpeg"].includes(r.type)){l.error("File harus berformat PNG atau JPEG");return}if(r.size>2*1024*1024){l.error("Ukuran file maksimal 2MB");return}p(r);const d=new FileReader;d.onload=E=>{f(E.target?.result)},d.readAsDataURL(r)}},S=async a=>{if(a.preventDefault(),s.newPassword){if(!s.currentPassword){l.error("Password saat ini harus diisi");return}if(s.newPassword!==s.confirmPassword){l.error("Konfirmasi password tidak cocok");return}if(s.newPassword.length<6){l.error("Password baru minimal 6 karakter");return}}try{b(!0);const r=new FormData;r.append("name",s.name),r.append("email",s.email),s.newPassword&&(r.append("current_password",s.currentPassword),r.append("password",s.newPassword),r.append("password_confirmation",s.confirmPassword)),w&&r.append("profile_photo",w);const i=await y.put("/api/admin/profile",r,{headers:{"Content-Type":"multipart/form-data"}});h(i.data),x(!1),p(null),f(null),u(d=>({...d,currentPassword:"",newPassword:"",confirmPassword:""})),l.success("Profil berhasil diperbarui"),await v()}catch(r){console.error("Error updating profile:",r),r.response?.data?.errors?r.response.data.errors.forEach(i=>{l.error(i)}):l.error("Gagal memperbarui profil")}finally{b(!1)}},L=()=>{x(!1),p(null),f(null),u({name:t?.name||"",email:t?.email||"",currentPassword:"",newPassword:"",confirmPassword:""})};return P?e.jsx(D,{text:"Memuat profil..."}):t?e.jsx(N,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Kelola informasi profil dan keamanan akun Anda"})]}),!o&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),e.jsx("span",{children:"Edit Profil"})]})]})}),e.jsxs("form",{onSubmit:S,children:[e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"flex items-start space-x-6",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden bg-gray-100 border-4 border-white shadow-lg",children:j||t.profilePhoto?e.jsx("img",{src:j||t.profilePhoto,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-400 to-blue-600 text-white",children:e.jsx("span",{className:"text-3xl font-bold",children:t.name.charAt(0).toUpperCase()})})}),o&&e.jsxs("div",{className:"text-center",children:[e.jsxs("label",{className:"cursor-pointer inline-flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"Pilih Foto"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:C})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPEG max 2MB"})]})]}),e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),o?e.jsx("input",{type:"text",name:"name",value:s.name,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),o?e.jsx("input",{type:"email",name:"email",value:s.email,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}):e.jsx("p",{className:"text-gray-900 font-medium",children:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:t.roleDisplayName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Member Since"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(t.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]}),o&&e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Ubah Password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Saat Ini"}),e.jsx("input",{type:"password",name:"currentPassword",value:s.currentPassword,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Kosongkan jika tidak ingin mengubah"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Baru"}),e.jsx("input",{type:"password",name:"newPassword",value:s.newPassword,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Password Baru"}),e.jsx("input",{type:"password",name:"confirmPassword",value:s.confirmPassword,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})]})]})}),o&&e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:L,disabled:m,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Batal"}),e.jsxs("button",{type:"submit",disabled:m,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[m&&e.jsx("div",{className:"w-4 h-4 animate-spin",children:e.jsxs("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("span",{children:m?"Menyimpan...":"Simpan Perubahan"})]})]})]})]})})}):e.jsx(N,{children:e.jsx("div",{children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Error"}),e.jsx("p",{className:"mt-2 text-sm text-red-700",children:"Gagal memuat profil admin"})]})})})};export{H as default};
